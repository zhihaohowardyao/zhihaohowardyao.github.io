<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.11.0">
<title>Descriptive Statistics | Clinical Trial Data Analysis</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air.9914ee1a.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air.9914ee1a.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.7e44a896.js">
<link rel="modulepreload" href="./_observablehq/runtime.c916ad99.js">
<link rel="modulepreload" href="./_observablehq/stdlib.3783f355.js">
<link rel="modulepreload" href="./_npm/d3-require@1.3.0/7ba36aef.js">
<link rel="modulepreload" href="./_import/components/mctad.f3072535.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/7055d4c5.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/063eb405.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.e3f2dfe6.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/c68fbd73.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e95f898e.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/d44feff9.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/5830b12a.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/84d7b8e9.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/2c0cdfa2.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/626bedc4.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/00c41b5d.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/b5f7cdc6.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/b22c5864.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/407f7a1f.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/6f15f633.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/ef1ec490.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e1ff060.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/5851d7ef.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/dcd02767.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/f1db2593.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/034b7bcb.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/4bb53638.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/bbafde58.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/aa5b35a8.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/32c7fec2.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/567840a0.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/cf9b720b.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/5dcd62f4.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/f8e03c56.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/5bc129e1.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/19c92b44.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/f31b5398.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/8debb4ba.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/4b0cc581.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/5eed35fd.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/e67acb27.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/8ac9039b.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.7e44a896.js";

define({id: "93b77afd", inputs: ["localStorage"], outputs: ["storedMasterData"], body: (localStorage) => {
const storedMasterData = JSON.parse(localStorage.getItem("masterData"));
return {storedMasterData};
}});

define({id: "5cafa3ae", outputs: ["require","mctad"], body: async () => {
const [{require}, {mctad}] = await Promise.all([import("./_npm/d3-require@1.3.0/7ba36aef.js"), import("./_import/components/mctad.f3072535.js")]);

return {require,mctad};
}});

define({id: "0442939d", inputs: ["require"], outputs: ["jStat"], body: async (require) => {
const jStat = await require("jstat"); 
return {jStat};
}});

define({id: "30e6d86f", inputs: ["storedMasterData"], outputs: ["endpointsVisits","endpoints","visits"], body: (storedMasterData) => {
const endpointsVisits = Object.keys(storedMasterData[0]).filter(d => d.includes('Visit'))
const endpoints = [... new Set(endpointsVisits.map(d => d.split('_')[0]))]
const visits = [... new Set(endpointsVisits.map(d => d.split('_')[1]))]
return {endpointsVisits,endpoints,visits};
}});

define({id: "c7af5827", inputs: ["view","Inputs","endpoints"], outputs: ["endpointSelected","subgroupSelected"], body: (view,Inputs,endpoints) => {
const endpointSelected = view(Inputs.select(endpoints, {value: "Endpoint1", label: "Select Endpoint:"}));
const subgroupSelected = view(Inputs.select(['SITE', 'SEX', 'RACE', 'FLG1', 'TRTEMFL'], {value: "SITE", label: "Select Subgroup:"}));
return {endpointSelected,subgroupSelected};
}});

define({id: "387ca216", inputs: ["storedMasterData","subgroupSelected","visits","endpointSelected","d3","display","html","Inputs"], outputs: ["curSubgrpCat"], body: (storedMasterData,subgroupSelected,visits,endpointSelected,d3,display,html,Inputs) => {
const curSubgrpCat = ['Total Cohort', ...[...new Set(storedMasterData.map(d => d[subgroupSelected]))].sort() ]

curSubgrpCat.forEach((subgroup,i) => {
    let r = []
    const curData = storedMasterData.filter(d => subgroup === 'Total Cohort' ? d : d[subgroupSelected] === subgroup)
    const cohort = subgroup === 'Total Cohort' ? subgroup : `${subgroupSelected} = ${subgroup}`

    visits.forEach(v => {
        const curArr = curData.map(d => d[`${endpointSelected}_${v}`])
        
        r.push({
            VISIT: v,
            N : curArr.length,
            MEAN : Math.round(d3.mean(curArr)*10)/10,
            SD : Math.round(d3.deviation(curArr)*10)/10,
            MEDIAN : Math.round(d3.median(curArr)*10)/10,
            MIN : Math.round(d3.min(curArr)*10)/10,
            MAX : Math.round(d3.max(curArr)*10)/10,
        })
    })
    display(html`<hr><h5>${cohort}</h5>`)
    display(Inputs.table(r))
})

return {curSubgrpCat};
}});

define({id: "98acd734", inputs: ["curSubgrpCat","subgroupSelected","visits","display","html","endpointSelected","storedMasterData","jStat","d3","mctad","gen_violin"], body: (curSubgrpCat,subgroupSelected,visits,display,html,endpointSelected,storedMasterData,jStat,d3,mctad,gen_violin) => {
  curSubgrpCat.forEach((subgroup, i) => {
    const title = subgroup === 'Total Cohort' ? subgroup : `${subgroupSelected} = ${subgroup}`
    const titleID = title.replaceAll(' ', '_').replaceAll('=', '_')
    const followUpNums = visits.slice(1).length
    let res = []

    display(
        html`
            <hr>
            <div style='flex:100%'>
                <b><small>${title}</small></b>
            </div>
            <div class='grid grid-cols-2 ${titleID}_rowContainer'></div>
            `
    )

    visits.slice(1).forEach((v,j) => {
        let r = []
        const curEndpoint =  `${endpointSelected}_${v}`
        const curEndpoint_BASELINE =  `${endpointSelected}_${visits[0]}`
        const curEndpoint_CHG =  `${endpointSelected}_${v}_CHG`

        const curEndpointDataSubgrp = subgroup === 'Total Cohort' ? 
                storedMasterData.filter(d => d[curEndpoint_CHG] !== null) : 
                storedMasterData.filter(d => d[curEndpoint_CHG] !== null & d[subgroupSelected] ===  subgroup)

        curEndpointDataSubgrp.forEach(e => {
            r.push({'SUBJID': e.USUBJID, 'VISIT': visits[0], 'VAL': e[curEndpoint_BASELINE]})
        })
        curEndpointDataSubgrp.forEach(e => {
            r.push({'SUBJID': e.USUBJID, 'VISIT': `${v}`, 'VAL': e[curEndpoint]})
        })

        const pvalue = jStat.ttest(0, curEndpointDataSubgrp.map(d => d[curEndpoint_CHG]), 2)

        const pValueOutput = pvalue < 0.001 ? `P < 0.001` : `P = ${Math.round(pvalue * 1000) / 1000}`
        const curEndpoint_CHG_Mean = Math.round(d3.mean(curEndpointDataSubgrp, d => d[curEndpoint_CHG])*10)/10
        const upper = Math.round(mctad.confidenceIntervalOnTheMean(
                            d3.mean(curEndpointDataSubgrp, d => d[curEndpoint_CHG]), 
                            d3.deviation(curEndpointDataSubgrp, d => d[curEndpoint_CHG]), 
                            curEndpointDataSubgrp.length, 
                            0.025, 
                            'u'
                        )*10)/10
        const lower = Math.round(mctad.confidenceIntervalOnTheMean(
                            d3.mean(curEndpointDataSubgrp, d => d[curEndpoint_CHG]), 
                            d3.deviation(curEndpointDataSubgrp, d => d[curEndpoint_CHG]), 
                            curEndpointDataSubgrp.length, 
                            0.025, 
                            'l'
                        )*10)/10

        res.push({
            'data': r, 
            'n': curEndpointDataSubgrp.length, 
            'pars': [pValueOutput, curEndpoint_CHG_Mean, lower, upper]
            })
    })

    
    res.forEach((d,i) => {
        d3.select(`div.${titleID}_rowContainer`)
            .append('div').html(`
                <div class='card'>
                    <center><small>
                    <div>N = ${d.n}</div>
                    <div >${d.pars[0]}</div>
                    <div id='${titleID}_rowContainer_${i}'></div>
                    <div >Mean Change 95% CI <br> ${d.pars[1]} [${d.pars[2]}, ${d.pars[3]}] </div>
                    </small></center>
                </div>
            `)
        gen_violin(`#${titleID}_rowContainer_${i}`, d.data, 'VISIT', 'VAL')
    })

})

}});

define({id: "c1dda455", inputs: ["d3","visits","mctad"], outputs: ["gen_violin","kde","epanechnikov"], body: (d3,visits,mctad) => {
function gen_violin(sel, data, dimension, val, bandwidth=12) {
// function gen_violin(data, dimension, val, bandwidth=12) {

    const height = 400,
        width = 400,
        margin = {left: 40, bottom: 40, right: 20, top: 20}

    const svg = d3.select(sel)
        .append('svg')
    // const svg = d3.create('svg')
        .attr('height', height)
        .attr('width', width)
        // .style('font-family', 'sans-serif')
        // .style('font-size', 12)

    const x = d3.scaleBand()
        .domain([...new Set(data.map(d => d[dimension]))])
        .range([margin.left, width - margin.right])
        .padding(0.05)

    const y = d3.scaleLinear()
        .domain([d3.min(data, d => d[val]), d3.max(data, d => d[val])]).nice()
        .range([height - margin.bottom, margin.top])

    const colors = d3.scaleOrdinal()
        .domain(visits)
        .range(['#9bc1bc', '#e07a5f','#3d405b'])

    const xAxis = g => g
        .attr('transform', `translate(0, ${height - margin.bottom})`)
        .call(d3.axisBottom(x).tickSizeOuter(0))

    const yAxis = g => g
        .attr('transform', `translate(${margin.left}, 0)`)
        .call(d3.axisLeft(y))
        // .call(g => g.select('.domain').remove())

    // const bandwidth = bandwidth;
    const thds = y.ticks(40)
    const density = kde(epanechnikov(bandwidth), thds)

    // console.log(thds)

    const violins = d3.rollup(
        data, 
        v => ({
            f: density(v.map(g => g[val])),
            n: v.length,
            m: d3.mean(v, g => g[val]),
            md: d3.median(v, g => g[val]),
            sd: d3.deviation(v, g => g[val]),
            u: mctad.confidenceIntervalOnTheMean(
                d3.mean(v, g => g[val]), 
                d3.deviation(v, g => g[val]), 
                v.length, 
                0.025, 
                'u'
                ), 
            l: mctad.confidenceIntervalOnTheMean(
                d3.mean(v, g => g[val]), 
                d3.deviation(v, g => g[val]), 
                v.length, 
                0.025, 
                'l'
                ), 
        }), 
        // v => density(v.map(g => g[val])),
        d => d[dimension])


    var allNum = [];
    [...violins.values()].forEach((d,i) => 
        allNum = allNum.concat([...violins.values()][i].f.map(d => d[1]))
    )
    
    
    const xNum  = d3.scaleLinear()
        .domain([-d3.max(allNum), d3.max(allNum)])
        .range([0, x.bandwidth()])

    const area = d3.area()
            .x0(d => xNum(-d[1]))
            .x1(d => xNum(d[1]))
            .y(d => y(d[0]))
            .curve(d3.curveNatural)

    svg.append('g')
    .call(xAxis)

    svg.append('g')
        .call(yAxis)
    

    const  g = svg.append('g')
                    .selectAll('g')
                    .data([...violins])
                    .join('g')
                    .attr('transform', d => `translate(${x(d[0])}, 0)`)
    
    g.append('path')
        .style('fill', d => colors(d[0]))
        .datum(d => d[1].f)
        .style('stroke', 'none')           
        .attr('d', area)

    g.append('circle')
        .attr('cx', xNum(0))
        .attr('cy', d => y(d[1].m))
        .attr('r', 6)
        .style('fill', '#fff')

    g.append('text')
        .attr('x', xNum(0))
        .attr('dx', 10)
        .attr('dy', 10)
        .attr('y', d => y(d[1].m))
        .text(d => Math.round(d[1].m))
        .style('fill', '#fff')
        .style('font-size', '26px')
        .style('font-weight', 'bold')

    g.append('line')
        .attr('x1', xNum(-d3.max(allNum)))
        .attr('x2', xNum(d3.max(allNum)))
        .attr('y1', d => y(d[1].u))
        .attr('y2', d => y(d[1].u))
        .style('stroke', '#fff')
        .style('stroke-width', 4)

    g.append('text')
        .attr('x', xNum(0))
        .attr('dx', -10)
        .attr('dy', -10)
        .attr('y', d => y(d[1].u))
        .text(d => Math.round(d[1].u))
        .style('fill', '#fff')
        .style('font-size', '26px')
        .style('font-weight', 'bold')

    g.append('line')
        .attr('x1', xNum(-d3.max(allNum)))
        .attr('x2', xNum(d3.max(allNum)))
        .attr('y1', d => y(d[1].l))
        .attr('y2', d => y(d[1].l))
        .style('stroke', '#fff')
        .style('stroke-width', 4)

    g.append('text')
        .attr('x', xNum(0))
        .attr('dx', -10)
        .attr('dy', 30)
        .attr('y', d => y(d[1].l))
        .text(d => Math.round(d[1].l))
        .style('fill', '#fff')
        .style('font-size', '26px')
        .style('font-weight', 'bold')

    g.append('line')
        .attr('x1', xNum(0))
        .attr('x2', xNum(0))
        .attr('y1', d => y(d[1].u))
        .attr('y2', d => y(d[1].l))
        .style('stroke', '#fff')
        .style('stroke-width', 4)

    return svg.node()
}

function kde(kernel, thds) {
    return V => thds.map(t => [t, d3.mean(V, d => kernel(t - d))])
}

function epanechnikov(bandwidth) {
    return x => Math.abs(x /= bandwidth) <= 1 ? 0.75 * (1 - x * x) / bandwidth : 0;
}
return {gen_violin,kde,epanechnikov};
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Clinical Trial Data Analysis</a></li>
  </ol>
  <section>
    <summary class="observablehq-link"><a href="./Enrollment-Monitoring">Enrollment Monitoring</a></summary>
    <ol>
    </ol>
  </section>
  <section>
    <summary>Analytical Data Simulation</summary>
    <ol>
    <li class="observablehq-link"><a href="./ADaM-Datasets">ADaM Datasets</a></li>
    <li class="observablehq-link"><a href="./Master-Dataset">Master Dataset</a></li>
    </ol>
  </section>
  <section class="observablehq-section-active">
    <summary>Dynamic Analysis</summary>
    <ol>
    <li class="observablehq-link observablehq-link-active"><a href="./Descriptive-Statistics">Descriptive Statistics</a></li>
    <li class="observablehq-link"><a href="./Summerized-Information">Summarized Information</a></li>
    <li class="observablehq-link"><a href="./Efficacy-Analyses">Efficacy Analyses</a></li>
    </ol>
  </section>
  <section>
    <summary>Output Tables</summary>
    <ol>
    <li class="observablehq-link"><a href="./Demographic-Table">Demographic Table</a></li>
    <li class="observablehq-link"><a href="./Primary-Table">Primary Table</a></li>
    <li class="observablehq-link"><a href="./Followup-Table">Visit Completion Table</a></li>
    </ol>
  </section>
  <section>
    <summary class="observablehq-link"><a href="./About-Author">About the Author</a></summary>
    <ol>
    </ol>
  </section>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
<div>Contents</div>
<ol>
<li class="observablehq-secondary-link"><a href="#summary-table">Summary Table</a></li>
<li class="observablehq-secondary-link"><a href="#distribution">Distribution</a></li>
</ol>
</nav>
</aside>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div class="observablehq observablehq--block"><!--:93b77afd:--></div>
<div class="observablehq observablehq--block"><!--:5cafa3ae:--></div>
<div class="observablehq observablehq--block"><!--:0442939d:--></div>
<h1 id="descriptive-statistics-total-cohort-vs-subgroups" tabindex="-1"><a class="observablehq-header-anchor" href="#descriptive-statistics-total-cohort-vs-subgroups">Descriptive Statistics <br> (Total Cohort vs Subgroups)</a></h1>
<br>
<blockquote>
<p>The Visualization section offers interactive tools designed to enhance the understanding of clinical trial results through graphical representation. These dynamic visualizations support descriptive statistics, comparative analyses, and efficacy evaluations, making it easier to communicate complex data insights effectively.</p>
</blockquote>
<hr>
<h1 id="summary-table" tabindex="-1"><a class="observablehq-header-anchor" href="#summary-table">Summary Table</a></h1>
<div class="observablehq observablehq--block"><!--:30e6d86f:--></div>
<div class="observablehq observablehq--block"><!--:c7af5827:--></div>
<div class="observablehq observablehq--block"><!--:387ca216:--></div>
<hr>
<h1 id="distribution" tabindex="-1"><a class="observablehq-header-anchor" href="#distribution">Distribution</a></h1>
<blockquote>
<p><strong>Violin plots</strong> features of both box plots and density traces, allowing you to visualize the distribution of continuous variables across different groups. It is especially useful for analyzing the spread and central tendency of key outcomes like patient biomarkers, treatment responses, or lab measurements. This tool helps identify differences in distributions and potential outliers.</p>
</blockquote>
<blockquote>
<p>The plots below demostrate the distributions of total cohort and subgroups. The mean change and 95% CI of V1/V2 vs Baseline are also presented.</p>
</blockquote>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:98acd734:--></div>
<div class="observablehq observablehq--block"><!--:c1dda455:--></div>
<style>
th, tr, td {
   text-align: center; 
}

  .hl blockquote {
    padding: 1em;
    border-left: 5px solid #1E4865;
  }

</style>   
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./Master-Dataset"><span>Master Dataset</span></a><a rel="next" href="./Summerized-Information"><span>Summarized Information</span></a></nav>
</footer>
</div>

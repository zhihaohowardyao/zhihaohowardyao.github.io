<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.11.0">
<title>Primary Table | Clinical Trial Data Analysis</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air.9914ee1a.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air.9914ee1a.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.7e44a896.js">
<link rel="modulepreload" href="./_observablehq/runtime.c916ad99.js">
<link rel="modulepreload" href="./_observablehq/stdlib.3783f355.js">
<link rel="modulepreload" href="./_npm/d3-require@1.3.0/7ba36aef.js">
<link rel="modulepreload" href="./_import/components/mctad.f3072535.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/7055d4c5.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/063eb405.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.e3f2dfe6.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/c68fbd73.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e95f898e.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/d44feff9.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/5830b12a.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/84d7b8e9.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/2c0cdfa2.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/626bedc4.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/00c41b5d.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/b5f7cdc6.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/b22c5864.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/407f7a1f.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/6f15f633.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/ef1ec490.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e1ff060.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/5851d7ef.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/dcd02767.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/f1db2593.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/034b7bcb.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/4bb53638.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/bbafde58.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/aa5b35a8.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/32c7fec2.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/567840a0.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/cf9b720b.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/5dcd62f4.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/f8e03c56.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/5bc129e1.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/19c92b44.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/f31b5398.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/8debb4ba.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/4b0cc581.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/5eed35fd.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/e67acb27.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/8ac9039b.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.7e44a896.js";

define({id: "c35cd7f1", inputs: ["localStorage"], outputs: ["storedMasterData","storedAdlbInputs"], body: (localStorage) => {
const storedMasterData = JSON.parse(localStorage.getItem("masterData"));
const storedAdlbInputs = JSON.parse(localStorage.getItem("adlbInputs"));
return {storedMasterData,storedAdlbInputs};
}});

define({id: "5cafa3ae", outputs: ["require","mctad"], body: async () => {
const [{require}, {mctad}] = await Promise.all([import("./_npm/d3-require@1.3.0/7ba36aef.js"), import("./_import/components/mctad.f3072535.js")]);

return {require,mctad};
}});

define({id: "0442939d", inputs: ["require"], outputs: ["jStat"], body: async (require) => {
const jStat = await require("jstat"); 
return {jStat};
}});

define({id: "55a0e3f1", inputs: ["storedMasterData","d3","mctad","jStat"], outputs: ["data","groupedWide","welchTTest"], body: (storedMasterData,d3,mctad,jStat) => {

const data = storedMasterData.slice().map(d => ({
    ...d,
    AGEGROUP: d.AGE < 60 ? '<60' :
              d.AGE >= 60 & d.AGE < 75 ? '60-75' :
              '>75'
}))

function groupedWide(data, dimension, val){
    return d3.rollup(
        data, 
        v => ({
            n: v.filter(d=> d[val]).length,
            m: d3.mean(v, g => g[val]),
            md: d3.median(v, g => g[val]),
            sd: d3.deviation(v, g => g[val]),
            min: d3.min(v, g => g[val]),
            max: d3.max(v, g => g[val]),
            u: mctad.confidenceIntervalOnTheMean(
                d3.mean(v, g => g[val]), 
                d3.deviation(v, g => g[val]), 
                v.length, 
                0.025, 
                'u'
                ), 
            l: mctad.confidenceIntervalOnTheMean(
                d3.mean(v, g => g[val]), 
                d3.deviation(v, g => g[val]), 
                v.length, 
                0.025, 
                'l'
                ), 
            v:v,
        }), 
        d => d[dimension])
}

function welchTTest(sample1, sample2){
    // Sample data
    // const sample1 = [12, 14, 15, 17, 19];
    // const sample2 = [10, 11, 13, 16];

    // Calculate means
    const mean1 = jStat.mean(sample1);
    const mean2 = jStat.mean(sample2);

    // Calculate variances
    const var1 = jStat.variance(sample1);
    const var2 = jStat.variance(sample2);

    // Calculate sample sizes
    const n1 = sample1.length;
    const n2 = sample2.length;

    // Calculate the standard error of the difference in means
    const se = Math.sqrt((var1 / n1) + (var2 / n2));

    // Calculate degrees of freedom (Welch-Satterthwaite equation)
    const df = Math.pow((var1 / n1) + (var2 / n2), 2) / 
                ((Math.pow(var1 / n1, 2) / (n1 - 1)) + (Math.pow(var2 / n2, 2) / (n2 - 1)));

    // Calculate t-statistic
    const t = (mean1 - mean2) / se;

    // Calculate p-value (two-tailed test)
    const pValue = 2 * (1 - jStat.studentt.cdf(Math.abs(t), df));

    // Calculate confidence interval (95%)
    const alpha = 0.05;
    const tCritical = jStat.studentt.inv(1 - alpha / 2, df);
    const marginOfError = tCritical * Math.sqrt((var1 / n1) + (var2 / n2));
    const confidenceInterval = [mean1 - mean2 - marginOfError, mean1 - mean2 + marginOfError];

    return {'pValue': pValue, 'se':se, 'confidenceInterval':confidenceInterval}
}

return {data,groupedWide,welchTTest};
}});

define({id: "323d969c", inputs: ["d3","storedAdlbInputs","view","Inputs"], outputs: ["endpoints","visits","endpointInput"], body: (d3,storedAdlbInputs,view,Inputs) => {
const endpoints = d3.range(1, storedAdlbInputs.endpoints+1).map(d => `Endpoint${d}`)
const visits = d3.range(storedAdlbInputs.visits).map(d => `Visit${d}`)

const endpointInput = view(Inputs.select(endpoints, {value: "Endpoint1", label: "Select Endpoint: "}));

return {endpoints,visits,endpointInput};
}});

define({id: "d9b60f18", inputs: ["data","visits","groupedWide","endpointInput","welchTTest"], outputs: ["tableJSON"], body: (data,visits,groupedWide,endpointInput,welchTTest) => {


const tableJSON = [
    {col1: '', col2: 'TRTEMFL=A', col3: 'TRTEMFL=B', col4:'HEADER_1'},
    {col1: '', col2: `(N=${data.filter(d=>d.TRTEMFL == 'A').length})`, col3: `(N=${data.filter(d=>d.TRTEMFL == 'B').length})`, col4:'HEADER_2'},
]

visits.forEach((visit, i) => {

    const  tmpData = groupedWide(data, 'TRTEMFL', `${endpointInput}_${visit}`)
    

    tableJSON.push({col1: ``, col2:'', col3:'', col4:`HEADER_Visit-${i}` })
    tableJSON.push({col1: `${visit === 'Visit0' ? 'Baseline' : visit}`, col2:'', col3:'', col4:`HEADER_Visit-${i}` })
    tableJSON.push({
        col1: `N`, 
        col2: `${tmpData.get('A').n}`, 
        col3: `${tmpData.get('B').n}`, 
        col4: `${endpointInput}_${visit}-${i}`
    })
    tableJSON.push({
            col1: `Mean (SD)`, 
            col2: `${tmpData.get('A').m.toFixed(1)} (${tmpData.get('A').sd.toFixed(2)})`, 
            col3: `${tmpData.get('B').m.toFixed(1)} (${tmpData.get('B').sd.toFixed(2)})`, 
            col4: `${endpointInput}_${visit}-${i}`
        })
    tableJSON.push({
            col1: `Median (Min; Max)`, 
            col2: `${tmpData.get('A').md.toFixed(1)} (${tmpData.get('A').min.toFixed(2)}; ${tmpData.get('A').max.toFixed(2)})`, 
            col3: `${tmpData.get('B').md.toFixed(1)} (${tmpData.get('B').min.toFixed(2)}; ${tmpData.get('B').max.toFixed(2)})`, 
            col4: `${endpointInput}_${visit}-${i}`
        })

    if (visit !== 'Visit0') {
        const  tmpDataChg = groupedWide(data, 'TRTEMFL', `${endpointInput}_${visit}_CHG`)
        // display(tmpDataChg)

        tableJSON.push({col1: `Change from Baseline (${visit})`, col2:'', col3:'', col4:`HEADER_Visit-${i}` })

        tableJSON.push({
            col1: `N`, 
            col2: `${tmpDataChg.get('A').n}`, 
            col3: `${tmpDataChg.get('B').n}`, 
            col4: `${endpointInput}_${visit}-${i}`
        })
        tableJSON.push({
                col1: `Mean (SD)`, 
                col2: `${tmpDataChg.get('A').m.toFixed(1)} (${tmpDataChg.get('A').sd.toFixed(2)})`, 
                col3: `${tmpDataChg.get('B').m.toFixed(1)} (${tmpDataChg.get('B').sd.toFixed(2)})`, 
                col4: `${endpointInput}_${visit}-${i}`
            })
        tableJSON.push({
                col1: `Median (Min; Max)`, 
                col2: `${tmpDataChg.get('A').md.toFixed(1)} (${tmpDataChg.get('A').min.toFixed(2)}; ${tmpDataChg.get('A').max.toFixed(2)})`, 
                col3: `${tmpDataChg.get('B').md.toFixed(1)} (${tmpDataChg.get('B').min.toFixed(2)}; ${tmpDataChg.get('B').max.toFixed(2)})`, 
                col4: `${endpointInput}_${visit}-${i}`
            })

        const wTTest = welchTTest(
                            tmpDataChg.get('A').v.map(d=>d[`${endpointInput}_${visit}_CHG`]), 
                            tmpDataChg.get('B').v.map(d=>d[`${endpointInput}_${visit}_CHG`])
                            )

        tableJSON.push({
                col1: `p-value (${visit}: Trt B - Trt A) `, 
                col2: ``, 
                col3: `${wTTest.pValue.toFixed(3)}`, 
                col4: `HEADER_Visit-${i}`
            })
        tableJSON.push({
                col1: `Diff of LS Means (SE)`, 
                col2: ``, 
                col3: `${(tmpDataChg.get('B').m - tmpDataChg.get('A').m).toFixed(1)} (${wTTest.se.toFixed(2)})`, 
                col4: `HEADER_Visit-${i}`
            })    
        tableJSON.push({
                col1: `95% CI `, 
                col2: ``, 
                col3: `(${wTTest.confidenceInterval.map(d=>`${d.toFixed(1)}`).join('; ')})`, 
                col4: `HEADER_Visit-${i}`
            })
    }
})


return {tableJSON};
}});

define({id: "1fdc1e4c", inputs: ["htl"], outputs: ["td_format_header","td_format_col1"], body: (htl) => {
const td_format_header = (d, i, data) =>
  data[i].col4.split('_')[0] === 'HEADER'
    ? htl.html`<div style="font-weight: bold;">${d}</div>`
    : htl.html`<div >${d}</div>`

const td_format_col1 = (d, i, data) =>
  data[i].col4.split('-')[0] === 'HEADER_Visit'
    ? htl.html`<div style="font-weight: bold;text-align:left;">${d}</div>`
    : htl.html`<div style="padding-left: 10px;text-align:left;">${d}</div>`

return {td_format_header,td_format_col1};
}});

define({id: "35f7c59a", inputs: ["Inputs","tableJSON","td_format_col1","td_format_header","display"], body: async (Inputs,tableJSON,td_format_col1,td_format_header,display) => {
display(await(
Inputs.table(tableJSON, {
    columns: ['col1', 'col2', 'col3',],
    header: {col1:'', col2:'', col3:'', col4:''},
    format: {
        col1: td_format_col1,
        col2: td_format_header,
        col3: td_format_header,
    },
    rows: (tableJSON.length + 1),
    height: (tableJSON.length + 1) * 25 - 1,
    maxHeight: (tableJSON.length + 1) * 25 - 1,
})
))
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Clinical Trial Data Analysis</a></li>
  </ol>
  <section>
    <summary class="observablehq-link"><a href="./Enrollment-Monitoring">Enrollment Monitoring</a></summary>
    <ol>
    </ol>
  </section>
  <section>
    <summary>Analytical Data Simulation</summary>
    <ol>
    <li class="observablehq-link"><a href="./ADaM-Datasets">ADaM Datasets</a></li>
    <li class="observablehq-link"><a href="./Master-Dataset">Master Dataset</a></li>
    </ol>
  </section>
  <section>
    <summary>Dynamic Analysis</summary>
    <ol>
    <li class="observablehq-link"><a href="./Descriptive-Statistics">Descriptive Statistics</a></li>
    <li class="observablehq-link"><a href="./Summerized-Information">Summarized Information</a></li>
    <li class="observablehq-link"><a href="./Efficacy-Analyses">Efficacy Analyses</a></li>
    </ol>
  </section>
  <section class="observablehq-section-active">
    <summary>Output Tables</summary>
    <ol>
    <li class="observablehq-link"><a href="./Demographic-Table">Demographic Table</a></li>
    <li class="observablehq-link observablehq-link-active"><a href="./Primary-Table">Primary Table</a></li>
    <li class="observablehq-link"><a href="./Followup-Table">Visit Completion Table</a></li>
    </ol>
  </section>
  <section>
    <summary class="observablehq-link"><a href="./About-Author">About the Author</a></summary>
    <ol>
    </ol>
  </section>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
</nav>
</aside>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div class="observablehq observablehq--block"><!--:c35cd7f1:--></div>
<div class="observablehq observablehq--block"><!--:5cafa3ae:--></div>
<div class="observablehq observablehq--block"><!--:0442939d:--></div>
<h1 id="fda-submission-tables" tabindex="-1"><a class="observablehq-header-anchor" href="#fda-submission-tables">FDA Submission Tables</a></h1>
<blockquote>
<p>The FDA Submission Tables section is designed to streamline the preparation of FDA submission packages by automating the generation of essential statistical tables. These tables are critical for new drug or medical device approval and must adhere to strict regulatory guidelines. This platform ensures that all submission tables align with the FDA's required format and content standards, ensuring compliance and accuracy in regulatory submissions.</p>
</blockquote>
<br>
<blockquote>
<ul>
<li>Protocol: CDISCDEMO01</li>
<li>Population: Intent-to-Treat</li>
</ul>
</blockquote>
<br>
<h3 id="primary-table" tabindex="-1"><a class="observablehq-header-anchor" href="#primary-table">Primary Table</a></h3>
<div class="observablehq observablehq--block"><!--:55a0e3f1:--></div>
<div class="observablehq observablehq--block"><!--:323d969c:--></div>
<div class="observablehq observablehq--block"><!--:d9b60f18:--></div>
<div class="observablehq observablehq--block"><!--:1fdc1e4c:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:35f7c59a:--></div>
<style>

td {
    text-align: center;
}​


</style>    
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./Demographic-Table"><span>Demographic Table</span></a><a rel="next" href="./Followup-Table"><span>Visit Completion Table</span></a></nav>
</footer>
</div>
